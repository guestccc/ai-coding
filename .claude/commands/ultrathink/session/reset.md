# 会话重置命令 (/ut:session/reset)

## 命令概述
重置当前会话状态，清理临时数据，恢复到初始状态或指定检查点，为新的开发阶段做准备。

## 命令语法
```bash
/ut:session/reset [target] [options]
```

### 参数说明
- `target` (可选): 重置目标 (clean|checkpoint|stage)
- `options` (可选): 重置选项标志

### 重置模式

#### 1. 完全重置 (默认)
```bash
用户: /ut:session/reset

系统: ⚠️  会话完全重置确认
      
      📋 将要清理的内容:
      ✓ 当前会话上下文 (23.4KB)
      ✓ 临时Agent输出 (8.7KB)  
      ✓ 工作内存缓存 (15.2KB)
      ✓ 引用映射表 (2.1KB)
      
      📦 将要保留的内容:
      ✓ 项目基础配置
      ✓ 核心文档引用
      ✓ 重要决策记录
      ✓ 历史会话备份
      
      确认执行重置? [y/N]: y
      
      🔄 正在重置会话...
      ✓ 清理临时数据完成
      ✓ 释放Token预算: 49.4KB  
      ✓ 重建基础上下文
      ✓ 激活默认Agent配置
      
      🎯 会话重置完成!
      📊 新会话状态: 
         - Token使用: 8.2KB/100KB (8%)
         - 可用内存: 91.8KB
         - 活跃Agent: 6个基础Agent
```

#### 2. 阶段重置
```bash
用户: /ut:session/reset stage T7

系统: 🔄 重置到阶段T7状态...
      
      📍 目标状态: T7 - 开发实现阶段开始
      📋 恢复内容:
      ✓ T1-T6阶段的所有成果
      ✓ 设计文档和架构决策
      ✓ 技术选型和环境配置
      
      🗑️ 清理内容:  
      ✓ T8及之后的所有变更
      ✓ 后续开发的临时文件
      ✓ 相关的Agent输出缓存
      
      🎯 阶段重置完成!
      📊 当前状态: T7/20 - 准备开始后端开发
```

#### 3. 检查点重置
```bash  
用户: /ut:session/reset checkpoint backend-complete

系统: 🏷️ 恢复到检查点: backend-complete
      
      📅 检查点信息:
         - 创建时间: 2024-01-01 12:00:00
         - 阶段状态: T8/20 
         - 描述: Express服务器和数据库层已实现
         
      🔄 正在恢复检查点状态...
      ✓ 元数据恢复完成
      ✓ 文件状态同步完成
      ✓ 上下文数据解压完成
      ✓ Agent配置激活完成
      
      🎯 检查点恢复完成!
      📍 当前状态与保存时完全一致
```

## 安全机制

### 重置前确认
- 显示将要清理的数据量
- 列出重要内容的保留策略  
- 提供撤销和恢复选项
- 要求用户明确确认操作

### 数据保护
- 自动创建重置前备份
- 重要文件自动保护标记
- 关键决策记录永久保留
- 支持重置操作回滚

### 渐进式清理
- 按优先级顺序清理数据
- 保留核心项目信息
- 智能识别可安全删除内容
- 提供清理过程详细日志

## 使用场景

### 开发阶段切换
```yaml
场景: 从开发阶段切换到测试阶段
操作: /ut:session/reset stage T17
效果: 清理开发期间的临时数据，保留核心成果
```

### 问题排查重置
```yaml  
场景: 遇到复杂问题需要从干净状态重新开始
操作: /ut:session/reset clean
效果: 完全清理当前状态，从基础配置重新开始
```

### 回滚到稳定状态
```yaml
场景: 最近的更改导致问题，需要回滚
操作: /ut:session/reset checkpoint last-stable
效果: 恢复到最后一个稳定的检查点状态
```

## 最佳实践建议

### 重置前准备
1. 确保重要工作已保存到检查点
2. 记录当前问题和重置原因
3. 评估重置范围和影响
4. 准备重置后的恢复计划

### 重置后恢复
1. 验证核心功能完整性
2. 重建必要的工作环境
3. 恢复重要的临时配置  
4. 更新项目状态和进度

---
**命令版本**: v1.3.0
**维护责任**: UltraThink会话管理团队
